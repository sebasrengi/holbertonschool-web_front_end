<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>Task 6</title>
    <script
      src="https://code.jquery.com/jquery-3.6.0.js"
      integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <script type="application/javascript">
      const [th, tr, td] = ["<th>", "<tr>", "<td>"]
      let validator = true;

      function createFamilyTree() {
        $('body').append("<table>").find('table')
          .append(tr)
          .append(tr)
          .append(tr)
          .append(tr)

          .find("tr")
          .eq(0)
            .append(th).find("th").first().text("Firstname").end().end()
            .append(th).find("th").last().text("Lastname").end().end()
          .end()

          .eq(1)
            .append(td).find("td").first().text("Guillaume").end().end()
            .append(td).find("td").last().text("Salva").end().end()
          .end()

          .eq(2)
            .append(td).find("td").first().text("Paulette").end().end()
            .append(td).find("td").last().text("Salva").end().end()
          .end()

          .eq(3)
            .append(td).find("td").first().text("Antoine").end().end()
            .append(td).find("td").last().text("Salva").end().end()
      }

      function addNewMember(firstName, lastName, position) {
        let trDetenctor = $("<tr></tr>");
        let x = $("<td>(x)</td>");

        if (validator) {
          $("table").html("<tr><th>Firstname</th><th>Lastname</th></tr>")
          validator = false;
        }

        x.css({"background-color": "orange", "cursor": "pointer"});
        x.click(() => {
          trDetenctor.remove()
        });

        trDetenctor.append("<td>" + firstName + "</td>");
        trDetenctor.append("<td>" + lastName + "</td>");
        trDetenctor.append(x);

        if (position === 'before') {
          $("table").append(trDetenctor);
        } else {
          $("table").append(trDetenctor);
        }
      }

      function createForm() {
        let selecOption = $("<select></select>");
        let buttonSubmit = $("<input type='submit'>");

        selecOption.append(
          "<option value='before'>Before</option>",
          "<option value='after'>After</option>"
        );

        buttonSubmit.click(() => {
          let val1 = $("input").first().val();
          let val2 = $("input:nth-of-type(2)").val();
          let val3 = selecOption.val();

          addNewMember(val1, val2, val3);
        });

        $("table").before(
          "<input type='text'>",
          "<input type='text'>",
          selecOption,
          buttonSubmit);
      }

      createFamilyTree();
      createForm();
    </script>
  </body>
</html>
